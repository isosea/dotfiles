#!/bin/bash

# ref: https://pihero.hatenadiary.jp/entry/2025/01/26/130123
# ref: https://github.com/KokiHirokawa/dotfiles/blob/d30aa3bf7bdd962d63e0bd25c82380d30398cec4/run_onchange_setup-mac.sh.tmpl

{{ if eq .chezmoi.os "darwin" -}}
configure_keyboard () {
    defaults write -g InitialKeyRepeat -int 12 # ãƒªãƒ”ãƒ¼ãƒˆå…¥åŠ›èªè­˜ã¾ã§ã®æ™‚é–“
    defaults write -g KeyRepeat -int 1 # ã‚­ãƒ¼ã®ãƒªãƒ”ãƒ¼ãƒˆé€Ÿåº¦
}

configure_dock () {
    # dockutilã‚³ãƒãƒ³ãƒ‰ãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    if ! command -v dockutil &> /dev/null; then
        echo "dockutilãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"
        echo "Homebrewã‚’ä½¿ã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„: brew install dockutil"
        return 1
    fi

    defaults write com.apple.dock autohide -bool true

    dockutil --remove all --no-restart
    # 4. è¨­å®šã‚’åæ˜ ã•ã›ã‚‹ãŸã‚ã«Dockã‚’å†èµ·å‹•
    echo "Dockã‚’å†èµ·å‹•ã—ã¦è¨­å®šã‚’é©ç”¨ã—ã¾ã™ã€‚"
    killall Dock

    echo "Dockã®è¨­å®šãŒå®Œäº†ã—ã¾ã—ãŸã€‚"
}

configure_other () {
    defaults write -g com.apple.trackpad.scaling -int 2
}

echo "ğŸš€ Setup user defaults..."
configure_keyboard
configure_dock
configure_other
echo "âœ… User defaults configured."
{{ end -}}
